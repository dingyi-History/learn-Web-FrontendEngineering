# 前端 code style

> 团队代码规范，是为了保持项目代码风格统一，以便新入职或者新接手的同学能够尽快熟悉代码并进行业务开发。


## 通用规范

- 编辑器统一采用4个space，因为不同的系统对tab解析不同，使用space能保证在不同平台下视觉效果一致

- js和css属性申明，统一使用分号结尾。便于压缩工具“断句”

- 为方便代码阅读，适当控制代码换行，大约60~80个字符左右需换行，避免出现过长的横向滚动条


## html规范

- 使用语义化的标签，不要通篇`div`和`span`

- 注意标签的嵌套，详见性能规范

- 杜绝任何以内联方式引入css、js和图片，内联工作由构建工具编译时按需嵌入。这样会带来后期的维护成本，多个地方引用需要copy，而且内联的代码很难压缩到

- 标签自定义属性统一采用`data-`的形式，自动埋点属性采用`data-report-[埋点名称]`的形式，便于统一上报


### id和class命名约定

- 基本原则: 内容优先，表现为辅。首先根据内容来命名，如:`#header`,`#footer`,`#mask`,`.main-nav`,`.popup`，如根据内容无法找到合适的命名，可以再结合表现进行命名，如：`col-main`,`col-sub`,`col-extra`,`box-float`

- 一律小写，多个单词以连字符连接（名称只出现，小写字母，数字和连字符`-`），如：`main-wrap`

- 尽量使用英文单词命名，如确实找不到合适的单词，可以使用拼音（拼音不要用缩写，容易混淆），如：`baidu-com`。在不影响语意的情况下，id 和 class 的名称可以适当使用英文缩写，如: `col`, `nav`, `hd`, `bd`, `fd`( 缩写只用来表示结构，不要写任何样式)，不要自造缩写。

- 状态类（配合js做状态切换）：选中使用`.selected`，（需要js切换的情况）鼠标悬浮用`.hover`，浮层的打开关闭切换用`.open`，不可用状态`.disabled`，等等，切记状态类不要单独定义样式，要配合其他class使用（比如不要出现`.selected {}`这样）

- 公共类：如隐藏用`.hide`，清除浮动用`.clearfix`，等等，这些类单独定义且全局生效

- 公共组件类约定：如遮罩用`.mask`，浮层用`.popup`，对话框用`.dialog`，提示框用`.toast`，购物车`.cart`,，回顶部`.go2top`等，全局生效

- 很多浏览器会将含有这些词的作为广告拦截： `ad`、`ads`、`adv`、`banner`、`sponsor`、`gg`、`guangg`、`guanggao`等尽量避免采用以上词汇来命名


## css规范

- 比较短并且语义比较泛、或者缩写的类名，如`.grid`,`.row`,`.box`,`.list`,`.line`,`.body`,`.title`,`.bd`,`.mod`等，注意它们的作用范围，前面务必请使用父类进行限定，如`.brand-mod .list`，不允许直接定义类似`.hd`的样式，对应的html结构类似：
``` xml
<div class="mod news-list">
    <h3 class="hd news-title"></h3>
    <div class="bd news-content"></div>
    <div class="ft news-info"></div>
</div>
```

- 不允许将多个属性写到一行，如`.brand-detail {margin: 10px; background-color: #DDD;}`，不方便注释且不易读，压缩应由工具来做

- 小图片（一般是icon图）必须合并成雪碧图

- 杜绝通配符，如`* {margin:0; padding:0;}`，优化css选择器（见性能规范篇）

- 每个页面，最多允许出现3个`<link>`标签引入外部css，一个是产品级别（即全站公用样式）、一个是组建级别（这个页面包含的组建样式）、一个是页面级别，可以根据需要在编译阶段进行内嵌


### z-index规范

- 页面级别：0-100

- 页面组建级别（如分仓浮层、详情页的预览浮层、浮动购物车等）：100-500

- 公共组建级别（如全局的对话框）：500-1000

- 个别特殊的：1000+


## 图片使用规范

- 能用css画的尽量不用图（如倒三角，纯色或渐变色背景），能复用的尽量复用

- 修饰性图片一律采用png（包括icon、默认底图等），内容型图片一律用jpg（如下载app图），尽可能不用gif（wap和专题好像都用不到，简单的都可以模拟）

- 伪类的妙用：如图片只做装饰并无点击交互时，可采用`:before`或`:after`，标签能少即少

- 命名规范：命名应该以图片内容来命名而不是用途，即`图片是什么.png`而不是`用于做什么.png`，相同内容不同size或者不用color的图片，根据先后顺序命名，如`arrow1.png`,`arrow2.png`


## javascript规范

- 命名规范：构造函数用首字母大写（如：`function Dialog() {}）`，组合变量或属性用小驼峰命名（如：`var myName = '';`），私有变量用`-`开头，jQuery/Zepto对象加`$`前缀（如：`var $box = $('#box');`）

- 语句必须都有分号结尾，除了`for`,`function`,`if`,`switch`, `try`,`while`，为了避免类似下面的错误出现：
``` js
var foo = function() {} //如果没有分号，这行代码压缩之后就成了函数调用，会报错
(function() {});
```

- 字符串统一使用单引号：不用按shift键并且避免了和html属性双引号冲突

- 单行过长应在适当位置予以换行，增强可读性，比如条件比较多的if语句（逻辑操作符要么都在行开头要么都在行结尾）：
``` js
if (condition1
    && condition2
    || condition3) {
}
```

- 适当空行，语法意义相互独立的代码将用空行分隔：
``` js
a++; b++; // ！！！避免同一行书写两个表达式
if (a > b) {
    value = a; // 行间不用空行间隔
}
// 这里用空行隔开
var variableName = value; // 与上一代码行使用空行间隔
```

- 变量申明应该在语句块开头，并且避免使用未申明的变量：
``` js
// 错
if(i > 1) {
    var foo = true;
}
// 对
var foo;
if(i > 1) {
    foo = true;
}
```

- 尽可能使用全等操作符（`===` 替代 `==`，`==!` 替代 `!=`）

